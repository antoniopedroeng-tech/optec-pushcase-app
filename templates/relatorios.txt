{% extends "base.html" %}
{% block content %}
<h2>Relatórios</h2>

<p>Baixe o relatório diário em Excel com as colunas: <strong>Fornecedor</strong>, <strong>Produto</strong>, <strong>Dioptria</strong>, <strong>Data</strong> e <strong>Valor</strong> (subtotal por item pago).</p>

<form method="get" action="{{ url_for('relatorio_diario_xlsx') }}" class="grid" style="max-width:520px;">
  <div>
    <label>Escolha o dia</label>
    <input type="date" name="date" value="{{ default_day }}">
  </div>
  <div style="align-self:end;">
    <button class="btn primary">Baixar Excel</button>
  </div>
</form>

{% if existing and existing|length > 0 %}
  <h3 style="margin-top:20px;">Relatórios já gerados</h3>
  <table>
    <tr><th>Data</th><th>Arquivo</th><th>Ação</th></tr>
    {% for f in existing %}
      <tr>
        <td>{{ f.day }}</td>
        <td>payments_{{ f.day }}.xlsx</td>
        <td><a class="btn small" href="{{ url_for('relatorio_diario_xlsx') }}?date={{ f.day }}">Baixar</a></td>
      </tr>
    {% endfor %}
  </table>
{% endif %}
{% endblock %}
