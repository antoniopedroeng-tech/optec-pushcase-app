{% extends "base.html" %}
{% block content %}
<h2>Pagador → Pendentes de Pagamento</h2>

<div class="flash info" style="margin-bottom:12px;">
  <strong>Atenção:</strong> pedidos de fornecedores com <em>Faturamento</em> não aparecem aqui.
  Eles entram automaticamente no relatório como <strong>FATURADOS</strong>.
</div>

<div style="margin:8px 0 16px;">
  <a class="btn" href="{{ url_for('extornos_index') }}">Extornar</a>
</div>

<table>
  <tr>
    <th>Pedido</th>
    <th>Fornecedor</th>
    <th>Comprador</th>
    <th>Total (R$)</th>
    <th>Crédito</th>
    <th>Criado</th>
    <th></th>
  </tr>
  {% for o in orders %}
  <tr>
    <td>#{{ o.id }}</td>
    <td>{{ o.supplier_name }}</td>
    <td>{{ o.buyer_name }}</td>
    {% if role == 'admin' %}<td>{{ o.payer_name or '—' }}</td>{% endif %}
    <td>{{ '%.2f'|format(o.total) }}</td>
    <td>
      {% if o.supplier_credit and o.supplier_credit > 0 %}
        <span class="badge" style="background:#e6f4ea; color:#137333;">
          crédito R$ {{ '%.2f'|format(o.supplier_credit) }}
        </span>
      {% else %}
        <span class="muted">—</span>
      {% endif %}
    </td>
    <td class="muted">{{ o.created_at }}</td>
    <td><a class="btn primary small" href="{{ url_for('pagamentos_detalhe', oid=o.id) }}">Pagar</a></td>
  </tr>
  {% endfor %}
  {% if orders|length == 0 %}
  <tr>
    <td colspan="7" style="text-align:center; color:#555; padding:16px;">
      Nenhum pagamento pendente.
    </td>
  </tr>
  {% endif %}
</table>
{% endblock %}
